<% include ../templates/header %>


<div id="listaItems" class="container">
    <div class="row layoutRow">
            <div id="layoutPath" class="col-md-12">
                <ul>
                    <li class="layoutPathItem"><a href="/">Home</a></li>
                    <li class="layoutPathItem before">Calendário</li>
                </ul>
            </div>
    </div>

    <div id="listaItemsHeader" class="row">
        <div class="col-xs-4">
            <h3>Calendário</h3>
        </div>
        <div class="col-xs-8">
            <% if(currentUser) { %>
            <a class="btn btn-primary pull-right" href="/calendar/new">Novo Calendário</a>
            <% } %>
        </div>
    </div>
    <br>
    
    <table class="table table-bordered table-hover">
        <thead>
            <tr>
                <td>Data</td>
                <td>Título</td>
                <td>Descrição</td>
                <td>Competência</td>
            </tr>
        </thead>
        <tbody>    
            
        <% calendar.forEach(function(cal) { %>
            
            <% var monthNames = ["Jan", "Fev", "Mar", "Abr", "Mai", "Jun", "Jul", "Ago", "Set", "Out", "Nov", "Dez"]; %>
            <% var title = cal.title; %>
            <% var desc = cal.description; %>
            <% var mes = cal.monthRef %>
            <% var date = dat(cal.date); %>
            <% var id = cal._id; %>
            
            <tr>
                    <td class="noticiaTitulo"><a href="/noticias/<%= id %>"><p><%= date %></p></a></td>
                    <td class="noticiaTitulo"><a href="/noticias/<%= id %>"><p><%= title %></p></a></td>
                    <td class="noticiaTitulo"><a href="/noticias/<%= id %>"><p><%= desc %></p></a></td>
                    <td class="noticiaTitulo"><a href="/noticias/<%= id %>"><p><%= dataMes(mes) %>/<%= mes.getFullYear(); %></p></a></td>
            </tr>
            
        <% }); %>
        
        </tbody>
    </table>
</div>

<% include ../templates/footer %>

<%
function dat(d){
    var data = d;
    var dia = data.getDate();
    if (dia.toString().length == 1)
      dia = "0"+dia;
    var mes = data.getMonth()+1;
    if (mes.toString().length == 1)
      mes = "0"+mes;
    var ano = data.getFullYear();  
    return dia+"/"+mes+"/"+ano;

}
function dataMes(d){
    var data = d;
    var mes = data.getMonth()+1;
    if (mes.toString().length == 1)
      mes = "0"+mes;
    return mes;
}
%>